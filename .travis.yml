dist: trusty
language: go
go:
  - "1.12"
env:
  - GO111MODULE=on
os:
  - linux
  - osx
before_install: &before_install
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo apt-get update; fi
install: &install
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo apt-get install -y libgl1-mesa-dev; fi
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo apt-get install -y libxcursor-dev; fi
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo apt-get install -y libxrandr-dev; fi
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo apt-get install -y libxinerama-dev; fi
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo apt-get install -y libxi-dev xsltproc; fi
script:
  - make
  - make lint
  - make test
jobs:
  include:
    - stage: "bundle"
      install: *install
      script:
        - make release
      os:
        - ox
stages:
  - "test"
  - "bundle"
